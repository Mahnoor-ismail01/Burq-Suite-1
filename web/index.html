<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title></title>     
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css" />
     <!-- Syntax Highlighting -->
     <script src="assets/codemirror/codemirror-5.65.0/lib/codemirror.js"></script>
     <link rel="stylesheet" href="assets/codemirror/codemirror-5.65.0/theme/ayu-dark.css">
     <link rel="stylesheet" href="assets/codemirror/codemirror-5.65.0/lib/codemirror.css">
     <script src="assets/codemirror/codemirror-5.65.0/mode/clike/clike.js"></script>
     <script src="assets/codemirror/codemirror-5.65.0/addon/display/autorefresh.js"></script>
 
  

  </head>
  <body>

    <!-- TOP CONTROLS -->
    <div class="d-flex justify-content-between align-items-center" id="controls">
      <img src="assets/icons/flash.png"onclick="gotosplash()"/>
      <h5> The Burq Suite </h5>
      <div class="d-flex">
        <button class="btn control_btns" id="minimize_btn"> _ </button>
        <button class="btn control_btns" id="maximize_btn"> ‚òê </button>
        <button onclick="window.close()" class="btn control_btns" id="close_btn"> X </button>  
      </div>
      
    </div>

    

    <!-- MAIN BODY  -->
    <div class="d-flex" style="height: 92vh;">

      <!-- SIDE BAR -->
      <div id="side_controls">
        <button onclick="openMenu(event, 'Explorer')" class="btn tablinks2 side_control_btns"> <img src="assets/icons/file.png" /> </button>
        <button onclick="openMenu(event, 'Search')" class="btn tablinks2 side_control_btns"> <img src="assets/icons/search.png" /> </button>
        <!-- <button onclick="openMenu(event, 'Run')" class="btn tablinks2 side_control_btns"> <img src="assets/icons/play.png" > </button> -->

      </div>
        <!-- EXPLORER -->
        <div id="Explorer" class="side_menus tabcontent2 side_menu">
          <p>Explorer</p>
          <div id="accord">
            <div id="filetree" class="accordion">
                <!-- <div class="accordion-item">
                  <p class="accordion-header" id="headingOne">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                         <img src="assets/icons/folder.png" /> Folder 1
                    </button>
                </p>
                  <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                      <div class="accordion-item">
                        <p class="accordion-header" id="headingTwo">
                          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                            <img src="assets/icons/folder.png" />  Folder 2
                          </button>
                        </p>
                        <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                          <div class="accordion-body">
                            <ul class="list-unstyled">
                              <li><button class="btn file-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-code-fill" viewBox="0 0 16 16">
                                  <path d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0zM9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1zM6.646 7.646a.5.5 0 1 1 .708.708L5.707 10l1.647 1.646a.5.5 0 0 1-.708.708l-2-2a.5.5 0 0 1 0-.708l2-2zm2.708 0 2 2a.5.5 0 0 1 0 .708l-2 2a.5.5 0 0 1-.708-.708L10.293 10 8.646 8.354a.5.5 0 1 1 .708-.708z"/>
                                </svg> File 1 </button></li>
                              <li><button class="btn file-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-code-fill" viewBox="0 0 16 16">
                                  <path d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0zM9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1zM6.646 7.646a.5.5 0 1 1 .708.708L5.707 10l1.647 1.646a.5.5 0 0 1-.708.708l-2-2a.5.5 0 0 1 0-.708l2-2zm2.708 0 2 2a.5.5 0 0 1 0 .708l-2 2a.5.5 0 0 1-.708-.708L10.293 10 8.646 8.354a.5.5 0 1 1 .708-.708z"/>
                                </svg> File 2 </button></li>
                              <li><button class="btn file-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-code-fill" viewBox="0 0 16 16">
                                  <path d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0zM9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1zM6.646 7.646a.5.5 0 1 1 .708.708L5.707 10l1.647 1.646a.5.5 0 0 1-.708.708l-2-2a.5.5 0 0 1 0-.708l2-2zm2.708 0 2 2a.5.5 0 0 1 0 .708l-2 2a.5.5 0 0 1-.708-.708L10.293 10 8.646 8.354a.5.5 0 1 1 .708-.708z"/>
                                </svg> File 3 </button></li>
                          </ul>
                          </div>
                        </div>
                      </div>
                        
                    </div>
                  </div>
                </div>
                <div class="accordion-item">
                  <p class="accordion-header" id="headingTwo">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                      <img src="assets/icons/folder.png" />  Folder 2
                    </button>
                  </p>
                  <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                    </div>
                  </div>
                </div>
                <div class="accordion-item">
                  <p class="accordion-header" id="headingThree">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                      <img src="assets/icons/folder.png" />  Folder 3
                    </button>
                </p>
                  <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                    </div>
                  </div>
                </div> -->
              </div>
          </div>
        </div>

        



        <div id="Search" class="side_menus tabcontent2 side_menu">
          <p>Search</p>
          <div>
            <input type="text" placeholder="Search" class="search-box" />
          </div>
        </div>

        <div id="Run" class="side_menus tabcontent2 side_menu">
          <p>Run and Debug</p>
          <div class="run-div">
            <button class="btn run-btn" id="dis" onclick="genrtl()"> Generate RTL </button> 
          </div>

          <div class="run-div">
            <button class="btn run-btn" id="dis" > Verify RTL </button> 
          </div>

          <div class="run-div">
            <button class="btn run-btn" id="dis" > Generate Report </button> 
          </div>

          <div class="run-div">
            <button class="btn run-btn" id="dis" > Generate Log </button> 
          </div>

          <div class="run-div">
            <button class="btn run-btn" id="dis" > Export CSV </button> 
          </div>

          <div class="run-div">
            <button class="btn run-btn" id="dis" > Upload Test </button> 
          </div>

          <div class="run-div">
            <button onclick="openBitstreamConfig()" class="btn run-btn" id="dis" > Upload Bitstream </button> 
          </div>
          
        </div>
        <!-- MAIN EDITOR -->

      <div id="main_editor">

        <!-- Tab links -->
        <div id="tab_space"  class="d-flex">
          <div id="tab_records" class="tab" style="width: 95%;overflow-x: scroll;display: flex;">
            <!-- <button class="tablinks" id="btn-File1" onclick="openTab(event, 'File1')" id="defaultOpen">File1 <span onclick="closeTab('btn-File1','File1')">x</span> </button> -->
            
          </div>
          <div id="play_panel">
            <img onclick="runtest()" src="assets/icons/play.png" />
            <img src="assets/icons/dots.png" />
          </div>
        </div>

        <div id="tab_name_space">
          <!-- /home/mahnoor -->
        </div>
        
        


        <!-- Tab content -->
        <!-- <div id="File1" class="tabcontent">
          <h6 class="table-header">Core: <span>Swerv</span></h6>
          <h6 class="table-header">ISS: <span>Whisper</span></h6>
          <table class="table table-dark">
            <thead>
              <tr>
                <th scope="col">Sr. </th>
                <th scope="col">Test Name</th>
                <th scope="col">Test Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="row">1</th>
                <td>Test 1</td>
                <td>Pass</td>
              </tr>
            </tbody>
          </table>

        </div> -->

        

      </div>

 

      
      </div>
      </div>
      <div id="footer">
        <div id="foot1">

        </div>
        <div id="foot2" class="d-flex align-items-center">
        
          
          <div class="space-10"></div>
          
          
          <div class="space-20"></div>
          

        </div>
      </div>



      
    </div>
    
    
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="jquery.min.js"></script>
    <script src="script.js"></script>
    <script type="text/javascript" src="/eel.js"></script>
    <script type="text/javascript">

eel.expose(showAlert);
function showAlert(c){
  alert(c);
}

eel.expose(cantOpenTheFile);
function cantOpenTheFile(){
  alert("Can't Open This File")
}

     

function closeTab(linkName, tabName){
    document.getElementById(linkName).remove();
    document.getElementById(tabName).remove();
}

        eel.expose(pakrKayLaoFiles)
        function pakrKayLaoFiles(strct){
          parseFileTree2(strct);
        }

        function openTheFile(file){
          var alreadyOpependFile = document.getElementById(file);
          // console.log(alreadyOpependFile);
          if(alreadyOpependFile != null){
            // openTab(alreadyOpependFile, file);
            document.getElementById(`btn-${file}`).click();
          } else{
            eel.parseFilePathReq(file);
          }
          
        }

        
          
                
            
        eel.expose(displayTheReport)
        function displayTheReport(core, iss,tests, status, idOfFile, nameOfFile, onlyNameOfFile){
          var tabRecords = document.getElementById("tab_records");
          tabRecords.innerHTML += `<button id="btn-${idOfFile}" class="tablinks" onclick="openTab(event, '${idOfFile}', '${nameOfFile}')">${onlyNameOfFile} <span onclick="closeTab(btn-'${idOfFile}', '${idOfFile}')">x</span> </button>`

          var editorRecords = document.getElementById("main_editor");
          var hello = ""
          hello += `<div id="${idOfFile}" class="tabcontent"><h6 class="table-header">Core: <span>${core}</span></h6>
          <h6 class="table-header">ISS: <span>${iss}</span></h6>
          <table class="table table-dark">
            <thead>
              <tr>
                <th scope="col">Sr. </th>
                <th scope="col">Test Name</th>
                <th scope="col">Test Status</th>
              </tr>
            </thead>
            <tbody>`;

              for(let i=0; i<tests.length; i++){
              hello += `
                
                  <tr><th scope="row">${i+1}</th>
                  <td>${tests[i]}</td>
                  <td>${status[i]}</td></tr>
                 `;
                  }
              hello+=`</tbody>
          </table></div>
          `;

          editorRecords.innerHTML += hello;

          var abhiWaliTab = document.getElementById(`btn-${idOfFile}`);
        // abhiWaliTab.click();
        // console.log(abhiWaliTab);
        abhiWaliTab.click();
              
        }

        eel.expose(displayTheFile)
        function displayTheFile(file, idOfFile, nameOfFile, onlyNameOfFile){
          var tabRecords = document.getElementById("tab_records");
          tabRecords.innerHTML += `<button id="btn-${idOfFile}" class="tablinks" onclick="openTab(event, '${idOfFile}', '${nameOfFile}')">${onlyNameOfFile} <span onclick="closeTab(btn-'${idOfFile}', '${idOfFile}')">x</span> </button>`

          var editorRecords = document.getElementById("main_editor");
          editorRecords.innerHTML += ` <div id="${idOfFile}" class="tabcontent">
          <textarea class="editorx" name="editor">${file}</textarea>

        </div>`;

        stylizeEditors(document.getElementById(idOfFile).getElementsByClassName("editorx")[0], idOfFile);

        var abhiWaliTab = document.getElementById(`btn-${idOfFile}`);
        // abhiWaliTab.click();
        // console.log(abhiWaliTab);
        abhiWaliTab.click();
        // openTab(abhiWaliTab, idOfFile);
        // abhiWaliTab.classList.add("active");
        }

        

        function parseFileTree2(strct){
          // var main = strct[""];
          // var parsedHTML = parser(main);
          var tree = document.getElementById("filetree") ;
          strct.replace("::marker", "");
          // console.log(strct);
          tree.innerHTML += strct;
        }

        eel.expose(cleanTheFileTree);
        function cleanTheFileTree(){
          var tree = document.getElementById("filetree") ;
          tree.innerHTML = "";
          var tabs = document.getElementById("tab_records");
          tabs.innerHTML = "";
          var editor = document.getElementsByClassName("tabcontent");
          for(let i=0; i<editor.length; i++){
            editor[i].style.display = "none";
          
            editor[i].remove();
          }

          
        }

        

        

        eel.getTheFileStrucuture();
        //generatertl
        function genrtl(){
          eel.genrtlpy()
        }
    eel.expose(disablefunction)
    function disablefunction(){
      var ss=document.getElementsByClassName("run-div").disabled=true;
      
    }
    function runtest(){
      var activeTab;
      var allTabs = document.getElementsByClassName("tablinks");
      for(var i = 0; i < allTabs.length; i++){
        if(allTabs[i].classList.contains("active")){
          activeTab = allTabs[i];
        }
      }
      console.log(activeTab);
      var allTheCode = getValueOfEditor(activeTab.id);
      eel.getcode(allTheCode);
      
    }
    function gotosplash(){
      eel.stop_index();
            window.close();
    }
        
    
    </script>
    
  </body>
</html>